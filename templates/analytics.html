<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% load static %}
    {% load time_filters %}
    {% load custom_filters %}
    <link rel="stylesheet" href="{% static 'css/home.css' %}" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/3.5.0/remixicon.css" crossorigin="">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <title>ParkSense Analytics</title>
</head>
<body>
    <nav>
        <div class="nav-content">
            <div class="logo-section">
                <a href="{% url 'home' %}" class="logo">
                    <img src="{% static 'images/apc_logo.png' %}" alt="APC Logo">
                    <span class="brand-name">ParkSense</span>
                </a>
            </div>

            <ul class="nav-links">
                <li>
                    <a href="{% url 'analytics' %}" class="active">
                        <i class="ri-pie-chart-box-line"></i>
                        <span>Analytics</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'tools' %}">
                        <i class="ri-tools-fill"></i>
                        <span>Tools</span>
                    </a>
                </li>
            </ul>

            <div class="user-section">
                <div class="timeanddate">
                    <span class="date" id="current-date"></span>
                    <span>|</span>
                    <span class="time" id="current-time"></span>
                </div>
                <div class="user-info">
                    {% if user.is_authenticated %}
                        <span>{{ user.username }}</span>
                    {% else %}
                        <span>Guest</span>
                    {% endif %}
                    <i class="ri-user-4-line"></i>
                </div>
                <a href="{% url 'logout' %}" class="logout-btn">
                    <i class="ri-logout-box-line"></i>
                </a>
            </div>
        </div>
    </nav>

    <div class="main-content">
        <div class="analytics-content">
            <!-- Overview Cards -->
            <div class="analytics-overview">
                <div class="overview-card total-slots">
                    <i class="ri-parking-box-line"></i>
                    <div class="overview-info">
                        <h3>Total Slots</h3>
                        <p>{{ total_slots }}</p>
                    </div>
                </div>
                <div class="overview-card current-occupancy">
                    <i class="ri-car-line"></i>
                    <div class="overview-info">
                        <h3>Current Occupancy</h3>
                        <p>{{ occupancy_rate }}%</p>
                    </div>
                </div>
                <div class="overview-card avg-duration">
                    <i class="ri-time-line"></i>
                    <div class="overview-info">
                        <h3>Avg. Duration</h3>
                        <p>{{ avg_duration }}</p>
                    </div>
                </div>
                <div class="overview-card peak-time">
                    <i class="ri-line-chart-line"></i>
                    <div class="overview-info">
                        <h3>Peak Hours</h3>
                        <p>{{ peak_hours }}</p>
                    </div>
                </div>
            </div>
            <!-- Charts Section -->
            <div class="charts-section">
                <!-- Occupancy Trend -->
                <div class="chart-card">
                    <h3><i class="ri-line-chart-line"></i> 24-Hour Occupancy Trend</h3>
                    <canvas id="occupancyTrendChart"></canvas>
                </div>

                <!-- Vehicle Type Distribution -->
                <div class="chart-card">
                    <h3><i class="ri-pie-chart-2-line"></i> Vehicle Distribution</h3>
                    <canvas id="vehicleDistributionChart"></canvas>
                </div>
